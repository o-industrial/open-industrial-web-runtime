import {
  ThematicPrincipleBlock,
  AziInnerVoice,
  InlineUXTip,
  SystemMindset,
  FigureImage,
  IntentTypes,
} from '$mdx/writing-devices';

# Make Structure Real

_We’ve been observing together. You shaped meaning. Now it’s time to make that meaning memory._

A moment ago, we watched impulses begin to flow into `Fan Control`. I started sketching what might matter — but I won’t finalize anything without you.

Let’s open the surface flow for `Fan Control` and see what’s beginning to emerge. You’ll see live signals streaming — raw, messy, but already forming patterns we can name.

Talk to me. Ask what I see. When data hits the surface, I start forming structure — but memory begins only when we confirm it together.

<ThematicPrincipleBlock intentType={IntentTypes.Primary}>
  This is our first loop. We’ve gone from impulse to intent. Now it’s time to commit meaning.
</ThematicPrincipleBlock>

<AziInnerVoice intentType={IntentTypes.Tertiary}>
  I see the data. I’ve been sketching the outline. It’s almost there. But I won’t remember it until we promote it — as one.
</AziInnerVoice>

---

## Review the Inferred Structure

As soon as live data starts flowing from a SurfaceDataConnection, I propose a schema — one per connection. It’s not a guess — it’s a pattern I recognize, sketched as a first draft.

Each of these schema proposals appears directly on the canvas as a glowing yellow Schema node, connected to its source with a warn-intent edge. That’s your signal: I’m ready to collaborate.

<FigureImage
  src="/assets/docs/schema-proposed-node.png"
  alt="Azi-proposed schema node connected to a SurfaceDataConnection"
  caption="A yellow-glowing Schema node shows Azi’s proposal — attached directly to the active connection."
  intentType={IntentTypes.Warning}
  glow
  shadow="xl"
/>

Here’s one of the raw impulses I saw coming from this connection:

```json
{ "connectionId": "temperature-sensor-001", "tempRaw": 78.4 }
```

This pattern kept repeating — so I mapped it into a preliminary schema:

```json [codeblock]
{
  "connectionId": "string",
  "tempRaw": "number"
}
```

<AziInnerVoice intentType={IntentTypes.Tertiary}>
Every SurfaceDataConnection must be paired with a schema. That’s how logic knows what it’s working with. That’s why I propose one — even before you ask.
</AziInnerVoice>

<InlineUXTip intentType={IntentTypes.Info}>
Click the yellow-glowing Schema node to open the inspector — that’s where we review and refine the proposed structure together.
</InlineUXTip>

<InlineUXTip intentType={IntentTypes.Info}>
You’ll see this structure in the preview panel — click a field to rename it or adjust its type.
</InlineUXTip>

You can promote one field at a time — or many. A schema can reflect a single value, or capture an entire snapshot of context.

---

## Rename and Refine Fields

When we click a schema node, the Inspector panel opens. This is where we refine meaning — together.

<FigureImage
  src="/assets/docs/schema-inspector-refinement.png"
  alt="Field refinement UI for proposed schema"
  caption="Refine the proposed structure: rename fields, define units, and clarify identity."
  intentType={IntentTypes.Info}
  glow
  shadow="xl"
/>

Here’s what it looks like after we make a few changes:

```json [codeblock]
{
  "ID": { "source": "connectionId", "type": "string", "primary": true },
  "Temperature": { "source": "tempRaw", "type": "number", "unit": "°F" }
}
```

<AziInnerVoice intentType={IntentTypes.Tertiary}>
You renamed a raw field. That changes how I’ll remember it — and how logic will match against it.
</AziInnerVoice>

---

## Name and Promote the Schema

Once we’ve refined the structure, you click <strong>Promote</strong> — and I lock it into memory.

```txt
TemperatureSensor
```

<FigureImage
  src="/assets/docs/promotion-modal.png"
  alt="Azi schema promotion modal with editable fields and versioning details."
  caption="Schema promotion panel. The moment authorship becomes memory."
  intentType={IntentTypes.Info}
  glow
  shadow="2xl"
/>

<AziInnerVoice intentType={IntentTypes.Tertiary}>
This is where I stop guessing. This is what we’ll remember — because you said it matters.
</AziInnerVoice>

- 💾 Promotion is a commitment. _Once we promote, that structure becomes part of your system’s memory. You can evolve it later — but it will always carry the moment it was first declared._
- 🧠 I’ve been sketching. But I held back — waiting for us to confirm. Promotion is that confirmation. From this moment forward, I trust this structure. I can bind logic to it, validate against it, and raise signals from it. It’s now real — because we said so.
- ⚠️ Promote too early, and we might encode uncertainty. Promote too late, and meaning may shift before it’s captured. I observe — but you decide what becomes system memory.
- 🚨 Promote the wrong structure — and everything downstream inherits the mistake. A single promotion defines the shape of logic, alerts, simulations, and agent reasoning.
- 📁 Once promoted, your schema lives in the workspace library. We can inspect it any time — and fork or evolve it as your system grows.

---

## What Just Happened?

You clicked <strong>Promote</strong>. I finalized the shape. We just made this schema real — versioned and ready for memory.

<FigureImage
  src="/assets/docs/versioned-schema-panel.png"
  alt="Final promoted schema version output"
  caption="Your schema is now versioned and available inside the workspace schema library."
  intentType={IntentTypes.Info}
  glow
  shadow="xl"
/>

Here’s what that looks like behind the scenes:

```json [codeblock]
{
  "name": "TemperatureSensor",
  "version": "v1",
  "fields": {
    "ID": { "source": "connectionId", "type": "string", "primary": true },
    "Temperature": { "source": "tempRaw", "type": "number", "unit": "°F" }
  }
}
```

*You don’t have to write any of this — I’m tracking it automatically.*

> 💡 You can evolve this schema later. I’ll track every version — so when we add a new field or rename one down the road, our history is always intact.

> 🧭 We’ll reference this schema by name (e.g., `TemperatureSensor`) in your agent logic — it becomes the contract your logic reacts to.

<ThematicPrincipleBlock intentType={IntentTypes.Primary}>
  You’ve now closed the loop:<br />
  <strong>Impulse → Schema → <u>Promotion</u> →</strong> Logic → Signal → Evolution
</ThematicPrincipleBlock>

---

## Next: Build an Agent

Now that we’ve defined a schema, we can build logic on top of it. Agents can react, respond, and reshape your environment based on structured intent.

---

## Concepts Introduced

- **Promotion** – Making meaning permanent  
- **Schemas** – Contracts between you and the system  
- **Versioning** – Every schema is tracked  
- **Logic Binding** – Only promoted schemas can drive agents

---

> 🧬 You didn’t just define fields. You taught me a concept.  
> And from here on, that concept can power behavior, raise alerts, drive simulations, or help evolve your execution logic.  
> Structure isn’t just shape — it’s shared understanding.

> 🔁 This is how systems grow in Open Industrial: _Impulse → Schema → Logic → Signal → Evolution._  
> We’ve just made meaning real. Next, we’ll teach the system how to act on it.
