# Forkable Runtime

<div class="border-l-4 border-electric-purple pl-4 italic text-electric-purple">
A runtime that canâ€™t be forked is a system that canâ€™t evolve. Forkable memory is how logic becomes legacy.
</div>

## From Export to Execution

You exported schemas, agents, surfaces, and replay logs.  
You didnâ€™t just export a system â€” you captured its first memory.

You built this with Azi beside you. But this memory runs without her.  
You taught it what to do â€” now itâ€™s time to see what others can do with it.

> This is your **Forkable Runtime** â€” a versioned memory that can be cloned, replayed, validated, and evolved.

## Folder Layout

```txt
roomstate-runtime/
â”œâ”€â”€ schemas/
â”œâ”€â”€ agents/
â”œâ”€â”€ surfaces/
â”œâ”€â”€ impulses/    # Replayable moments. This is what your agent saw.
â”œâ”€â”€ openindustrial.config.json
â”œâ”€â”€ .forkable-runtime.json (optional)
â”œâ”€â”€ Dockerfile
â””â”€â”€ README.md
```

Each part serves a purpose:
- `schemas/`: Versioned structure definitions
- `agents/`: Logic components tied to schema evolution
- `surfaces/`: Where logic runs â€” live or mocked
- `impulses/`: Timestamped event memory for audit + replay
- `openindustrial.config.json`: Deployment target hints (e.g. MQTT, staging)
- `.forkable-runtime.json`: Your runtimeâ€™s contract
- `Dockerfile`: Portable execution base
- `README.md`: Instructions, lineage notes, restore commands

```txt
Forkable Runtime
â”œâ”€â”€ Memory Structure
â”‚   â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ surfaces/
â”‚   â””â”€â”€ impulses/
â”œâ”€â”€ Manifest: .forkable-runtime.json
â”œâ”€â”€ Config: openindustrial.config.json
â””â”€â”€ Operations:
    â”œâ”€â”€ replay
    â”œâ”€â”€ validate
    â”œâ”€â”€ promote
    â””â”€â”€ fork
```

<aside class="border-l-4 border-yellow-400 pl-4 text-yellow-900 bg-yellow-50">
âš ï¸ <strong>What Doesnâ€™t Export:</strong><br/>
- Transient signals (unconfirmed â€” must be committed)<br/>
- Aziâ€™s speculative scaffolds<br/>
- UI-only drafts<br/>
- Unpromoted schema or agent drafts<br/>
- Any runtime secrets or cloud credentials
</aside>

## Manifest Contract

```json
{
  "name": "roomstate-runtime",
  "createdBy": "you@company.com",
  "impulseCount": 92,
  "agentVersions": {
    "FanControlAgent": "v2"
  },
  "forkedFrom": "mainline-sim-export",
  "env": "sim"
}
```

Think of `.forkable-runtime.json` as your runtimeâ€™s resume.  
It tells your system â€” and your team â€” whatâ€™s included, whatâ€™s trusted, and where it came from.

```bash
# Validate manifest integrity
openindustrial validate --manifest .forkable-runtime.json
```

```bash
$ openindustrial validate --manifest bad-runtime.json
âœ– Missing required field: agentVersions
âœ– Field forkedFrom must be a string
```

## Replaying and Validating Memory

```bash
# Replay all impulses (read-only)
openindustrial replay impulses/impulses.json

# Commit signals (stateful replay)
openindustrial replay impulses/impulses.json --commit-signals

# Replay outcome snapshot
âœ“ Replayed 92 impulses
âœ“ FanControlAgent-v2 triggered 3 signals
âœ“ No schema drift detected
âœ“ Replay duration: 1.4s
```

```bash
# Validate before promoting
openindustrial runtime validate --env staging
```

```bash
$ openindustrial runtime validate --env staging
âœ“ schemas: all pinned
âœ“ agents: bound to surfaces
âœ“ surfaces: mock/live separation validated
âœ– impulses: contains 4 untyped entries
```

<aside class="border-l-4 border-yellow-400 pl-4 text-yellow-900 bg-yellow-50">
âœ… <strong>Pre-deploy Check:</strong><br/>
All schemas pinned, agents mapped, surfaces valid. Impulses typed. Promotion safe.
</aside>

<aside class="border-l-4 border-yellow-400 pl-4 text-yellow-900 bg-yellow-50">
ğŸ”œ <strong>Coming Soon:</strong><br/>
Scoped replay by agent, surface, or time window:<br/>
<code>replay --from 50 --to 92 --agent FanControlAgent</code>
</aside>

## Fork, Diff, and Trace Lineage

```bash
# Fork your runtime
openindustrial runtime fork ./roomstate-runtime

# Compare agent logic
openindustrial agents diff FanControlAgent-v1 FanControlAgent-v2

# Trace version lineage
openindustrial runtime lineage ./roomstate-runtime
```

```txt
ğŸ“¦ roomstate-runtime
â”œâ”€â”€ forkedFrom: mainline-sim-export
â”œâ”€â”€ created: 2025-04-21T10:41Z
â”œâ”€â”€ agents:
â”‚   â””â”€â”€ FanControlAgent-v2 (forked from v1)
â””â”€â”€ surfaces:
    â””â”€â”€ Lab1_Mock (diffed from Lab1, signal raised: HumidityThreshold drift)
```

<aside class="border-l-4 border-indigo-500 pl-4 italic">
Replay isnâ€™t a post-mortem. Itâ€™s a prelude. Your next fork begins with a remembered moment â€” not a guess.
</aside>

## Common Use Cases

| Use Case                     | CLI Command                            | Evolves? | Needs Azi? |
|-----------------------------|----------------------------------------|----------|------------|
| Replay QA scenario          | `replay impulses/impulses.json`        | No       | No         |
| Test agent logic fork       | `agents diff`, `replay --agent X`      | Yes      | No         |
| Staging validation gate     | `validate`, `promote --env staging`    | No       | No         |
| Audit or fork-by-signal     | `replay --commit-signals`              | Optional | Yes        |

<aside class="border-l-4 border-electric-purple pl-4 italic text-electric-purple">
âœ… Promoted structure  
âœ… Forked logic  
âœ… Replayed memory  
âœ… Diffed behavior  
âœ… CLI-only deployment  
âœ… Runs without UI or AI
</aside>

## Whatâ€™s Next?

This isnâ€™t a snapshot. Itâ€™s a seed.

QA can simulate it. SREs can diff it. Devs can fork it.  
Teams can replay what happened â€” and evolve what comes next.

Run it in a hurricane drill. No UI. No AI. Just memory.

```txt
ğŸ“ Operator Log:
- QA forked runtime
- Replayed with Lab1_Mock surface
- Detected divergence on HumidityThreshold at impulse #77
- Signal raised â†’ FanControlAgent-v3 under review
```

<aside class="border-l-4 border-electric-purple pl-4 italic text-electric-purple">
You wrote the rules of this runtime. The next system wonâ€™t need your syntax â€” it will start with your memory.
</aside>

ğŸ‘‰ Youâ€™ve now exported a runtime memory that can be forked, validated, and promoted.  
